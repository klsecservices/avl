| Vulnerability | CVE-2024-38112 |
|---------------|----------------|
| **Type** | MSHTML Platform Spoofing Vulnerability |
| **Description** | The vulnerability occurs when a file is named with non-printable arbitrary characters to hide its extension. The APT employs various tactics to deceive victims into clicking and running an HTA file, including: <ul><li>Hiding the **.hta** file extension.</li><li>Using a misleading icon, such as a PDF icon, for a .url file.</li><li>Utilizing the mshtml protocol to launch Internet Explorer, which is deprecated on Windows 10 and 11, instead of Microsoft Edge.</li></ul> |
| **The Impact of the Bug** | Exploiting this vulnerability can lead to Remote Code Execution when the victim is tricked into clicking and running an HTA file. This attack can be combined with other vulnerabilities in Internet Explorer, which is now out of support and retired. |
| **How to detect if you have a vulnerable application to this attack vector?** | **several ways :** <ul><li>**Process Monitoring:** <ul><li>Look for iexplore.exe and mshta.exe running under svchost DcomLaunch services.</li></ul></li><li>**File Analysis:** <ul><li>Inspect URL files for mshtml and x-usc directives.</li></ul></li><li>**Browser Artifacts:** <ul><li>Check Internet Explorer's visit history and cache for HTA files.</li></ul></li><li>**Event Logs:** <ul><li>Monitor Windows Event ID 28117 in Microsoft-Windows-Shell-Core for full URLs encoded in .url files.</li></ul></li><li>**Execution Artifacts:** <ul><li>Look for execution traces of mshta.exe and iexplore.exe.</li></ul></li></ul> |
| **References** | [https://research.checkpoint.com/2024/resurrecting-internet-explorer-threat-actors-using-zero-day-tricks-in-internet-shortcut-file-to-lure-victims-cve-2024-38112/](https://research.checkpoint.com/2024/resurrecting-internet-explorer-threat-actors-using-zero-day-tricks-in-internet-shortcut-file-to-lure-victims-cve-2024-38112/)<br>[https://www.trendmicro.com/en_us/research/24/g/cve-2024-38112-void-banshee.html](https://www.trendmicro.com/en_us/research/24/g/cve-2024-38112-void-banshee.html)<br>[https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38112](https://msrc.microsoft.com/update-guide/vulnerability/CVE-2024-38112) |
